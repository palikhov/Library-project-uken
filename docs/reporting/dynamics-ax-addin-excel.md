---
title: Использование надстройки Microsoft Dynamics AX для Excel
summary: можно использовать Excel для импортирования данных в Microsoft Dynamics AX. Можно экспортировать данные из Microsoft Dynamics AX в книгу Excel, динамически связанную с таблицами в Microsoft Dynamics AX. Также можно создать шаблоны Excel для их совместного использования с другими сотрудниками.
authors:
    - Anton Palikhov
date: 2019-21-06
---

[Об использовании надстройки Microsoft Dynamics AX для Excel](https://docs.microsoft.com/ru-ru/dynamicsax-2012/appuser-itpro/about-using-the-microsoft-dynamics-ax-add-in-for-excel)

[Об импорт данных из Microsoft Excel](https://docs.microsoft.com/ru-ru/dynamicsax-2012/appuser-itpro/about-importing-data-from-microsoft-excel)

[Обновление данных Microsoft Dynamics AX с помощью Microsoft Excel](https://docs.microsoft.com/ru-ru/dynamicsax-2012/appuser-itpro/update-microsoft-dynamics-ax-data-by-using-microsoft-excel)

[Основные задачи: Создание и совместное использование шаблона Excel с помощью надстроек Office](https://docs.microsoft.com/ru-ru/dynamicsax-2012/appuser-itpro/key-tasks-create-and-share-an-excel-template-by-using-the-office-add-ins)

#
# Об использовании надстройки Microsoft Dynamics AX для Excel

Можно экспортировать много форм, списков и отчетов из Microsoft Dynamics AX и Корпоративный портал для Microsoft Dynamics AX в Microsoft Excel. Если форма, список или отчет имеет кнопку  **Экспорт в Microsoft Excel**  на  **Панель действий** , можно экспортировать данные в Excel.

Если системный администратор установил Надстройки Office для Microsoft Dynamics AX, вкладка  **Dynamics AX**  добавляется на ленту в Excel. Если ваша роль пользователя имеет доступ к данным в клиенте Microsoft Dynamics AX и разрешения на обновление экспортированных данных, можно обновить данные, экспортируемые из Microsoft Dynamics AX в Excel.

Чтобы определить, имеет ли роль разрешение на обновление экспортированных данных, выполните следующие действия.

1. Щелкните  **Файл**  \&gt;  **Инструменты**  \&gt;  **Параметры**.
2. В форме  **Параметры**  на экспресс-вкладке  **Разное**  проверьте поле  **Рабочая книга поддерживает обновление**. Если установлено значение  **При возможности** , можно обновить данные, экспортированные в Excel.
3. Подтвердите, что поле  **Сеанс удаленного рабочего стола экспортируется в:**  имеет значение  **Клиент Excel**. Если выбран этот параметр, можно создать файл Excel, который содержит экспортированные данные и сохранить файл на локальном компьютере.

Свяжитесь с системным администратором для получения дополнительной информации об этих параметрах.

Надстройка Office для Excel позволяет выполнять следующие задачи:

- **Обновление данных**  — экспортируйте данные в Excel, а затем создайте графики, отчеты со сводными таблицами и другим условным форматированием, используя эти данные. Впоследствии, когда нужно будет просмотреть обновленные данные в отчетах или графиках со сводными таблицами, можно обновить лист Excel. В этом случае таблица, формулы и графики, созданные с использованием этих экспортированных данных, также обновляются.
- **Выберите поля для включения в экспортированные данные**  — экспортируйте данные в Excel, а затем, в листе Excel, добавьте столбцы, содержащие соответствующие данные из других форм, списков, таблиц и отчетов.

Примечание

Данные, выбранные в дополнительных столбцах, должны быть связаны с экспортированными данными. Ваш системный администратор скажет вам, имеют ли данные, которые требуется добавить, ключ, связанный с экспортированными данными.

- **Изменение сопоставления полей**  — измените имена экспортированных столбцов в Excel, но сохраните динамические связи с исходными данными. Например, список  **Все клиенты**  можно экспортировать в Excel. Измените заголовок первого столбца с  **Название**  на  **Клиент**. При обновлении списка заголовок столбца сохраняет свое название  **Клиент**.
- **Обновление данных в Microsoft Dynamics AX**  — экспортируйте данные в Excel, измените данные и добавьте новые строки данных в лист Excel, а затем импортируйте обновленные данные в Microsoft Dynamics AX.

#
# Об импорт данных из Microsoft Excel

Данные могут импортированы в Microsoft Dynamics AX с помощью различных инструментов и методов. Для использования некоторых инструментов и техник требуются солидные знания о системе Microsoft Dynamics AX. Ими должен пользоваться разработчик или системный администратор. Более подробную информацию об импорте данных с помощью инструментов разработчика можно найти в [Plan data import, export, and migration](https://technet.microsoft.com/ru-ru/library/aa548629(v=ax.60)).

Также можно импортировать данные в Microsoft Dynamics AX с помощью Microsoft Excel. Используйте один из следующих методов:

- Создайте файл Excel, преобразуйте его в XML-файл, соответствующий именам полей, ограничениям по символам и другим требованиям Microsoft Dynamics AX. Данный способ должен использоваться только разработчиком или системным администратором, которому знакомы таблицы в базе данных Microsoft Dynamics AX.
- Экспортируйте форму, список или отчет в Excel, введите в файле данные для соответствующих столбцов, а затем импортируйте обновленные данные обратно в Microsoft Dynamics AX. Рекомендуется использовать этот метод для обновления существующих записей. Также советуем импортировать малые наборы данных. Дополнительные сведения об обновлении записей с помощью Excel см. в разделе

# Обновление данных Microsoft Dynamics AX с помощью Microsoft Excel

Надстройки Office для Microsoft Dynamics AX можно использовать для экспорта данных из Microsoft Dynamics AX в Microsoft Excel. После экспорта данных из форм, списков и отчетов Microsoft Dynamics AX в Excel, можно изменить информацию и импортировать данные обратно в Microsoft Dynamics AX для обновления записей.

Примечание

Для использования надстройки Office для Excel, необходимо установить следующие программы:

- Майкрософт Excel 2010 или Майкрософт Office Excel 2007
- Надстройки Office для Microsoft Dynamics AX. Дополнительной информацию об установке Надстройки Office, см. [Install Office Add-ins](https://technet.microsoft.com/ru-ru/library/gg731844(v=ax.60)).

После экспорта данных из Microsoft Dynamics AX в книгу Excel, можно использовать средства и функции в Excel, чтобы работать более подробно с экспортированными данными. Например, можно отфильтровать данные, добавить форматы, и использовать отчет сводной таблицы для суммирования вашего запроса данных.

### Выбор данных, чтобы экспортировать в Excel

1. Запустите Excel.
2. На ленте на вкладке  **Dynamics AX**  щелкните  **Соединение** , выберите сервер Microsoft Dynamics AX, к которому необходимо подключиться, а затем нажмите  **ОК**.
3. Щелкните  **Добавить данные** , установите флажок для запроса источника данных, который необходимо использовать, а затем щелкните  **ОК**.
4. В левой области выберите значение заголовка по умолчанию, который включить в запросе данных.

Можно выбрать заголовок и нажать кнопку  **Вставить значение**  или можно перетащить заголовок к соответствующей ячейке в листе Excel.

Повторите этот шаг до тех пор, пока не будут добавлены все поля заголовка для этого запроса данных.

1. В левой области выберите поле, которое включить в запросе данных.

Можно выбрать поле и нажать кнопку  **Вставить столбец**  или можно перетащить поле к соответствующей ячейке в листе Excel.

Повторите этот шаг до тех пор, пока не будут добавлены все поля для этого запроса данных.

1. Щелкните  **Выбор параметров** , а затем выберите параметры для полей, которые выбраны для запроса данных.

Например, чтобы создать запрос данных, чтобы просмотреть все проекты &quot;Время и расходы &quot;, выберите  **Expense.Project.Project type = Время и расходы**.

1. Щелкните  **Опубликовать данные**.

После сохранения книги, данные обновляются для последних проводок при следующем открытии данной книги.

## См. также

[Использование надстройки Microsoft Dynamics AX для Excel](https://docs.microsoft.com/ru-ru/dynamicsax-2012/appuser-itpro/using-the-microsoft-dynamics-ax-add-in-for-excel)

[Интеграция Microsoft Dynamics AX с Microsoft Office](https://docs.microsoft.com/ru-ru/dynamicsax-2012/appuser-itpro/integrating-microsoft-dynamics-ax-with-microsoft-office)

[Microsoft TechNet](http://go.microsoft.com/fwlink/?linkid=275089)

# Основные задачи: Создание и совместное использование шаблона Excel с помощью надстроек Office

Microsoft Dynamics AX 2012 автоматически интегрируется с Microsoft Excel. Средства и функции Excel можно использовать для работы с данными в AX 2012. Можно экспортировать данные из AX 2012 в Excel, поработать с данными в этом приложении, а затем импортировать их назад в AX 2012.

Книгу Excel можно создать в качестве шаблона, структурированного таким образом, чтобы он работал с таблицами и полями в AX 2012. Например, можно создать шаблон бюджетирования со списком финансовых счетов и аналитик из плана счетов организации в AX 2012. Затем можно отправить копию шаблона лицам, ответственным за подготовку бюджета. Если сведения о бюджете являются полными, их можно импортировать в AX 2012.

Если системный администратор создает библиотеку шаблонов, шаблон Excel можно сохранить в библиотеке, а затем использовать повторно или скопировать на будущий бюджетный период.

Данные, которые включаются в шаблон, ограничиваются разрешениями, связанными с назначенной пользователю ролью. Обычно, если определенные данные можно просматривать и изменять в клиенте Microsoft Dynamics AX, эти же данные можно просматривать, добавлять и изменять в шаблоне. Если шаблон является общим, другие пользователи также должны иметь разрешения на просмотр и изменение данных в этом шаблоне.

Перед созданием шаблона системный администратор должен настроить личные параметры, чтобы можно было обновлять данные в шаблоне Excel. Дополнительные сведения о способах просмотра настроек для Excel см. в разделе [Об использовании надстройки Microsoft Dynamics AX для Excel](https://docs.microsoft.com/ru-ru/dynamicsax-2012/appuser-itpro/about-using-the-microsoft-dynamics-ax-add-in-for-excel).

Для изменения шаблона, который был создан другим лицом, необходимо сохранить копию шаблона на компьютере. При использовании шаблона, который был создан системным администратором, шаблон может содержать столбцы и строки, которые вы не можете изменять. Если необходимо изменить макет шаблона, обратитесь к лицу, создавшему шаблон.

## Что вы хотите сделать?

Создание шаблона Excel

Совместное использование шаблона Excel

Найти связанные задачи

## Создание шаблона Excel

1. На странице списка в Microsoft Dynamics AX, на  **области действий**  щелкните  **Экспорт в Excel**.
2. Введите имя файла для книги Excel.

Внимание!

При выборе существующего файла, выполняется перезапись содержимого.

1. Сохраните файл как шаблон Excel на локальном компьютере.
2. В Excel в ленте на вкладке  **Dynamics AX**  выберите поля, которые требуется включить в книгу.

1.
  1. Щелкните  **Выбор полей** , выберите поле для добавления, а затем нажмите кнопку  **\&gt;**. Чтобы выбрать несколько полей, удерживайте клавишу CTRL, выберите все поля, а затем нажмите кнопку  **\&gt;**.

Если вы хотите, чтобы шаблон использовал поля, которые не отображаются в левой панели, щелкните  **Новые данные**  \&gt;  **Добавление таблиц**.

Начиная с Накопительный пакет обновления 7 для Microsoft Dynamics AX 2012 R2, при добавлении финансовых аналитик доступны только аналитики, указанные в форме  **Конфигурация финансовой аналитики для интеграции приложений**.

1.
  1. Для добавления объектов на панели  **Выбранные объекты**  выберите таблицу и нажмите кнопку  **\&gt;**. Чтобы выбрать несколько таблиц, удерживайте клавишу CTRL, выберите все таблицы, а затем нажмите кнопку  **\&gt;**.
  2. Чтобы удалить все ранее выбранные объекты, нажмите кнопку  **\&lt;\&lt;**.
2. В левой области выберите поля, которые нужно добавить в шаблон.
3. Сохраните файл на компьютере. Если системный администратор создал библиотеку шаблонов для AX 2012, шаблон можно отправить системному администратору для сохранения в библиотеке.

## Совместное использование шаблона Excel

При создании книги Excel для импорта данных в AX 2012 книгу можно сохранить как шаблон, а затем совместно использовать шаблон с другими сотрудниками. Например, организация заполняет годовой бюджет по подразделениям, и подразделения настроены в AX 2012 как финансовые аналитики. Можно создать шаблон бюджетирования со списком финансовых счетов, а затем сделать копию шаблона книги для каждого подразделения или аналитики. После этого копию шаблона книги можно использовать для каждого подразделения для подготовки бюджета подразделения.

После создания и сохранения книги на локальном компьютере системный администратор может сохранить ее в библиотеке шаблонов или другом расположении совместного пользования файлами.

При использовании Microsoft Dynamics AX 2012 R3 или накопительное обновление 6 либо более поздней версии для AX 2012 R2 системный администратор может указать в качестве расположения для экспорта папку Майкрософт Office 365 SharePoint. После сохранения шаблона в папке SharePoint Online можно открыть шаблон из папки SharePoint при использовании версии Office 365 Excel. Для определения расположения, настроенного для экспортированных файлов, щелкните  **Файл**  \&gt;  **Сервис**  \&gt;  **Параметры**. Расположение отображается в форме  **Параметры**  на вкладке  **Общие**  в разделе  **Разное**  в поле  **Расположение экспорта**.

[Использование надстройки Microsoft Dynamics AX для Excel](https://docs.microsoft.com/ru-ru/dynamicsax-2012/appuser-itpro/using-the-microsoft-dynamics-ax-add-in-for-excel)

[Об импорт данных из Microsoft Excel](https://docs.microsoft.com/ru-ru/dynamicsax-2012/appuser-itpro/about-importing-data-from-microsoft-excel)

[Настройка интеграции с надстройками Microsoft Office](https://docs.microsoft.com/ru-ru/dynamicsax-2012/appuser-itpro/set-up-integration-with-microsoft-office-add-ins)

[Настройка финансовых аналитик для интеграции приложений (Excel и Management Reporter)](https://docs.microsoft.com/ru-ru/dynamicsax-2012/appuser-itpro/set-up-financial-dimensions-for-integrating-applications-excel-and-management-reporter)

# Настройка финансовых аналитик для интеграции приложений (Excel и Management Reporter)

В этом разделе показано, как определить финансовые аналитики, доступные при поиске в Microsoft Excel при использовании Надстройки Office для Microsoft Dynamics AX, и порядок отображения финансовых аналитик в Management Reporter для Microsoft Dynamics ERP. Эту функцию можно использовать для добавления финансовых аналитик в лист бюджетного планирования в Excel или для разработки финансовых отчетов в Management Reporter.

В данной процедуре описываются функциональные возможности, доступные в Microsoft Dynamics AX 2012 R3 или накопительное обновление 7 либо более поздней версии для AX 2012 R2.

## Необходимые условия

В следующей таблице показаны обязательные компоненты, которые должны быть подготовлены до начала работы.

| **Категория** | **Необходимые условия** |
| --- | --- |
| Настройка | Настройка финансовых аналитик и значений финансовых аналитик. Дополнительные сведения см. в следующих разделах:
- [Создать финансовую аналитику](https://docs.microsoft.com/ru-ru/dynamicsax-2012/appuser-itpro/create-a-financial-dimension)
- [Значения финансовой аналитики (форма)](https://technet.microsoft.com/ru-ru/library/hh242667(v=ax.60))
 |

## 1. Настройка атрибутов финансовых аналитик для Надстройки Office

Эта процедура используется для определения финансовых аналитик, доступных при поиске в Надстройки Office для Microsoft Dynamics AX. Дополнительные сведения см. в разделе [Использование надстройки Microsoft Dynamics AX для Excel](https://docs.microsoft.com/ru-ru/dynamicsax-2012/appuser-itpro/using-the-microsoft-dynamics-ax-add-in-for-excel).

Чтобы настроить атрибуты финансовых аналитик для Надстройки Office, выполните следующие действия.

1. Щелкните  **Главная книга**  \&gt;  **Настройка**  \&gt;  **Финансовые аналитики**  \&gt;  **Конфигурация финансовой аналитики для интеграции приложений**.
2. В области  **Надстройки Office**  выберите финансовые аналитики, которые могут использоваться в качестве источников данных документов в приложениях, таких как Microsoft Excel.

Выбранные аналитики будут доступны при поиске в Excel, если финансовые аналитики активны. Финансовая аналитика активна, если системная дата Microsoft Dynamics AX находится в диапазоне, определенном полями  **Активен с**  и  **Активен по**  в форме  **Значения финансовых аналитик**. Если финансовая аналитика неактивна, она не отображается при поиске в Excel.

1. Нажмите кнопку  **Закрыть**. Создается пользовательский запрос, затем создается и активируется пользовательский источник данных документа для каждой выбранной финансовой аналитики. Если запрос с именем запроса по умолчанию уже существует для финансовой аналитики, выводится сообщение, и можно ввести уникальное имя запроса.
2. Необязательно: убедитесь, что источники данных документа были созданы. Щелкните  **Управление организацией**  \&gt;  **Настройка**  \&gt;  **Управление документами**  \&gt;  **Источники данных документа**.

## 2. Настройка атрибутов финансовых аналитик для Management Reporter

Эта процедура используется для определения порядка отображения финансовых аналитик в Management Reporter. Дополнительные сведения о Management Reporter см. в разделе о [Management Reporter для Microsoft Dynamics ERP](http://go.microsoft.com/fwlink/?linkid=324762).

Чтобы настроить атрибуты финансовых аналитик для Management Reporter, выполните следующие действия.

1. Щелкните  **Главная книга**  \&gt;  **Настройка**  \&gt;  **Финансовые аналитики**  \&gt;  **Конфигурация финансовой аналитики для интеграции приложений**.
2. В области  **Management Reporter**  разместите атрибуты аналитик в том порядке, в котором они должны отображаться в Management Reporter.

При добавлении новых финансовых аналитик после определения порядка в этой форме аналитики добавляются в конец списка по умолчанию. Если аналитики удаляются из Microsoft Dynamics AX, они удаляются из списка в Management Reporter.

[Создать финансовую аналитику](https://docs.microsoft.com/ru-ru/dynamicsax-2012/appuser-itpro/create-a-financial-dimension)

[Настройка плана счетов](https://docs.microsoft.com/ru-ru/dynamicsax-2012/appuser-itpro/setting-up-the-chart-of-accounts)

[Настройка стандартных финансовых отчетов](https://docs.microsoft.com/ru-ru/dynamicsax-2012/appuser-itpro/setting-up-traditional-financial-statements)

## Техническая информация для системных администраторов

При отсутствии доступа к страницам, которые необходимы для выполнения этой задачи, свяжитесь с системным администратором и предоставьте сведения, представленные в следующей таблице.

| **Категория** | **Необходимые условия** |
| --- | --- |
| **Конфигурационные ключи** | Для этой задачи конфигурационный ключ не требуется. |
| **Роли безопасности и привилегии** | Чтобы настроить финансовые аналитики для интеграции приложений, необходимо быть членом роли безопасности, включающей следующие привилегии.
- **Ведение обработки документа**  (DocumentHandlingMaintain)
- **Просмотреть финансовые аналитики**  (DimensionDetailsView)
 |

## См. также

[Финансовый аналитик (форма)](https://technet.microsoft.com/ru-ru/library/hh209534(v=ax.60))